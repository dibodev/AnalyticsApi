{"openapi":"3.0.0","info":{"title":"Dibodev Analytics - API Documentation","version":"1.0.0"},"paths":{"/analytics.js":{"get":{"tags":["AnalyticsScript"],"summary":"Retrieves the analytics script","responses":{"200":{"description":"Analytics script returned successfully","content":{"application/javascript":{"schema":{"type":"string","format":"binary"}}}}}}},"/event":{"post":{"tags":["Event"],"summary":"Collect visitor data","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Event_post_request"}}}},"responses":{"200":{"description":"Data collected successfully.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Event"}}}}}}},"/leave":{"post":{"tags":["Event"],"summary":"Handle visitor leave action","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Event_post_request"}}}},"responses":{"200":{"description":"Operation successful.","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true}}}}}}}}},"/projects":{"get":{"tags":["Project"],"summary":"Get all projects","description":"Get all projects with visitor count in the last 24 hours","operationId":"getAllProjects","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Projects"}}}}}},"post":{"tags":["Project"],"summary":"Create a new project","description":"Create a new project","operationId":"createProject","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateProject"}}}},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Project"}}}}}}},"/projects/{id}":{"get":{"tags":["Project"],"summary":"Get a project by id","description":"Get a project by id","operationId":"getProjectById","parameters":[{"name":"id","in":"path","description":"id of project","required":true,"schema":{"type":"number"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Project"}}}},"404":{"description":"Project not found"}}},"put":{"tags":["Project"],"summary":"Update a project by id","description":"Update a project by id","operationId":"updateProjectById","parameters":[{"name":"id","in":"path","description":"id of project","required":true,"schema":{"type":"number"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProject"}}}},"responses":{"200":{"description":"Project updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Project"}}}},"404":{"description":"Project not found"}}},"delete":{"tags":["Project"],"summary":"Delete a project by id","description":"Delete a project by id","operationId":"deleteProjectById","parameters":[{"name":"id","in":"path","description":"id of project","required":true,"schema":{"type":"number"}}],"responses":{"204":{"description":"Project deleted"},"404":{"description":"Project not found"}}}},"/stats/{domain}/top-stats":{"get":{"tags":["Stats"],"summary":"Get top stats for a specific domain","parameters":[{"name":"domain","in":"path","description":"Domain name to get stats for","required":true,"schema":{"type":"string","example":"dibodev.com"}}],"responses":{"200":{"description":"Successful operation.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StatsResponse"}}}}}}}},"components":{"schemas":{"Event_post_request":{"type":"object","properties":{"url":{"type":"string","example":"https://example.com"},"referrer":{"type":"string","nullable":true,"example":"https://google.com"},"domain":{"type":"string","example":"example.com"},"userAgent":{"type":"string","example":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4585.0 Safari/537.36"}}},"Event":{"type":"object","properties":{"visitorId":{"type":"string","example":"7d789b96c4c328abe8c53099668a93e202bf54a7d6391276f361ffa06e4f0638"},"event":{"$ref":"#/components/schemas/VisitorEvent"},"session":{"$ref":"#/components/schemas/Session"},"browserName":{"type":"string","nullable":true,"example":"Chrome"},"osName":{"type":"string","nullable":true,"example":"Windows"},"deviceType":{"type":"string","example":"Desktop"},"geo":{"$ref":"#/components/schemas/Geo"},"referrer":{"type":"string","nullable":true,"example":"https://google.com"},"url":{"type":"string","example":"https://example.com"}}},"Geo":{"type":"object","properties":{"range":{"type":"array","items":{"type":"number"},"minItems":2,"maxItems":2,"example":[1,65536]},"country":{"type":"string","example":"US"},"region":{"type":"string","example":"CA"},"eu":{"type":"string","enum":["1","0"],"example":"1"},"timezone":{"type":"string","example":"America/Los_Angeles"},"city":{"type":"string","example":"Los Angeles"},"ll":{"type":"array","items":{"type":"number"},"minItems":2,"maxItems":2,"example":[34.0522,-118.2437]},"metro":{"type":"number","example":803},"area":{"type":"number","example":50}}},"Location_post_request":{"type":"object","properties":{"country":{"type":"string","example":"France"},"region":{"type":"string","example":"Île-de-France"},"city":{"type":"string","example":"Paris"}}},"Location":{"type":"object","properties":{"id":{"type":"number","example":1},"country":{"type":"string","example":"France"},"region":{"type":"string","example":"Île-de-France"},"city":{"type":"string","example":"Paris"},"visitors":{"type":"array","items":{"$ref":"#/components/schemas/Visitor"}},"createdAt":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"},"updatedAt":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"}}},"CreateProject":{"type":"object","properties":{"domain":{"type":"string","example":"example.com"}}},"UpdateProject":{"type":"object","properties":{"domain":{"type":"string","example":"example.com"}}},"Project":{"type":"object","properties":{"id":{"type":"number","example":1},"domain":{"type":"string","example":"example.com"},"favicon":{"type":"string","example":"https://example.com/favicon.png"},"active":{"type":"boolean","example":true},"created_at":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"},"updated_at":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"}}},"Projects":{"type":"array","items":{"type":"object","properties":{"project":{"$ref":"#/components/schemas/Project"},"visitorLast24Hours":{"type":"number","example":100}}}},"Session":{"type":"object","properties":{"id":{"type":"number","example":1},"visitor_id":{"type":"number","example":123456},"active":{"type":"boolean","example":true},"session_start":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"},"session_end":{"type":"string","format":"date-time","nullable":true},"visit_duration":{"type":"number","example":123456,"nullable":true},"updated_at":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"},"created_at":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"}}},"TopStat":{"type":"object","properties":{"change":{"type":"number","nullable":true,"example":24},"comparison_value":{"type":"number","nullable":true,"example":142119},"name":{"type":"string","example":"Unique visitors"},"value":{"type":"number","example":176140}}},"StatsResponse":{"type":"object","properties":{"comparing_from":{"type":"string","format":"date","nullable":true,"example":"2023-08-07"},"comparing_to":{"type":"string","format":"date","nullable":true,"example":"2023-09-06"},"from":{"type":"string","format":"date","example":"2023-09-04"},"imported_source":{"type":"string","nullable":true},"interval":{"type":"string","example":"date"},"sample_percent":{"type":"number","example":100},"to":{"type":"string","format":"date","example":"2023-10-04"},"top_stats":{"type":"array","items":{"$ref":"#/components/schemas/TopStat"}},"with_imported":{"type":"boolean","example":false}}},"Visitor_post_request":{"type":"object","properties":{"visitorId":{"type":"string","example":"v1234567"},"projectId":{"type":"number","example":1},"locationId":{"type":"number","example":2,"nullable":true}}},"Visitor":{"type":"object","properties":{"id":{"type":"number","example":10},"visitorId":{"type":"string","example":"v1234567"},"projectId":{"type":"number","example":1},"locationId":{"type":"number","example":2,"nullable":true},"location":{"$ref":"#/components/schemas/Location"},"visitorEvents":{"type":"array","items":{"$ref":"#/components/schemas/VisitorEvent"}},"project":{"$ref":"#/components/schemas/Project"},"createdAt":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"},"updatedAt":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"}}},"VisitorEvent_post_request":{"type":"object","properties":{"visitorId":{"type":"number","example":1},"browser":{"type":"string","example":"Chrome","nullable":true},"os":{"type":"string","example":"Windows","nullable":true},"url":{"type":"string","example":"https://example.com/page1","nullable":true},"deviceType":{"type":"string","example":"Desktop","nullable":true},"referrer":{"type":"string","example":"https://google.com","nullable":true}}},"VisitorEvent":{"type":"object","properties":{"id":{"type":"number","example":10},"visitor_id":{"type":"number","example":1},"browser":{"type":"string","example":"Chrome","nullable":true},"os":{"type":"string","example":"Windows","nullable":true},"device_type":{"type":"string","example":"desktop","nullable":true},"url":{"type":"string","example":"https://example.com/page1","nullable":true},"referrer":{"type":"string","example":"https://google.com","nullable":true},"created_at":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"},"updated_at":{"type":"string","format":"date-time","example":"2023-08-01T13:48:18.239+00:00"}}}}},"tags":[]}